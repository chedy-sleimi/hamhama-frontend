<!-- src/app/ingredient/ingredient-list/ingredient-list.component.html -->
<h2>Manage Ingredients</h2>

<app-loading-spinner *ngIf="loading"></app-loading-spinner>
<app-error-message [message]="error || editError"></app-error-message>
<div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>


<!-- Add Ingredient Form -->
<div class="add-ingredient-form">
    <h4>{{ editingIngredient ? 'Edit Ingredient' : 'Add New Ingredient' }}</h4>
    <form [formGroup]="ingredientForm" (ngSubmit)="saveIngredient()">
        <div class="form-group">
             <label for="name">Name</label>
             <input type="text" id="name" formControlName="name" [ngClass]="{ 'is-invalid': submitted && f['name'].errors }">
              <div *ngIf="submitted && f['name'].errors" class="invalid-feedback">
                 <div *ngIf="f['name'].errors['required']">Name is required</div>
             </div>
        </div>
         <div class="form-group button-group">
            <button type="submit" [disabled]="saving">
                 <span *ngIf="!saving">{{ editingIngredient ? 'Update' : 'Add' }}</span>
                 <span *ngIf="saving">Saving...</span>
            </button>
             <button type="button" *ngIf="editingIngredient" (click)="cancelEdit()" class="cancel-button">Cancel Edit</button>
        </div>
    </form>
</div>


<!-- Ingredient List Table -->
<table *ngIf="!loading && ingredients.length > 0" class="ingredient-table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let ingredient of ingredients">
            <td>{{ ingredient.id }}</td>
            <td>{{ ingredient.name }}</td>
            <td>
                 <button (click)="startEdit(ingredient)" class="edit-button">Edit</button>
                 <button (click)="deleteIngredient(ingredient.id)" class="delete-button" [disabled]="deletingIngredientId === ingredient.id">
                     <span *ngIf="deletingIngredientId !== ingredient.id">Delete</span>
                     <span *ngIf="deletingIngredientId === ingredient.id">...</span>
                </button>
                 <!-- Add Substitutes / Generate Image buttons if needed here -->
            </td>
        </tr>
    </tbody>
</table>

<p *ngIf="!loading && ingredients.length === 0">No ingredients found.</p>